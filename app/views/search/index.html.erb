<%- model_class = Initiative -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize %></h1>
</div>
<table class="table table-striped table-bordered" id="data">
  <thead>
    <tr>
      <th><%= model_class.human_attribute_name(:state_id) %>
      	<%= select_tag('search_state', options_from_collection_for_select(@states, "abbrev", "abbrev"), :prompt => "All States " )%>
      </th>
        <th><%= model_class.human_attribute_name(:start_year) %></th>
      <th><%= model_class.human_attribute_name(:end_year) %></th>
      <th>Topic
       	<%= select_tag('search_topic', options_from_collection_for_select(@topics, "name", "name"), :prompt => "All Topics " )%>
      </th>
      <th>Population
      	<%= select_tag('search_population', options_from_collection_for_select(@populations, "target", "target"), :prompt => "All Populations" )%>
      </th>
      <th>Professional Development
      	<%= select_tag('search_pd', options_from_collection_for_select(@pds, "name", "name"), :prompt => "Al PDs" )%>
      </th>
      <th>Implementation
      	<%= select_tag('search_implementation', options_from_collection_for_select(@stages, "name", "name"), :prompt => "Al Implementations" )%>
      </th>
      <th><%= model_class.human_attribute_name(:description) %></th>
      <th><%= model_class.human_attribute_name(:resources) %></th>
    </tr>
  </thead>
   <tfoot>
    <tr>
      <th><%= model_class.human_attribute_name(:state_id) %></th>
      <th><%= model_class.human_attribute_name(:start_year) %></th>
      <th><%= model_class.human_attribute_name(:end_year) %></th>
      <th>Topic</th>
      <th>Population</th>
      <th>Professional Development</th>
      <th>Implementation</th>
      <th><%= model_class.human_attribute_name(:description) %></th>
      <th><%= model_class.human_attribute_name(:resources) %></th>
    </tr>
  </tfoot>

  <tbody>
    <% @initiatives.each do |initiative| %>
      <tr>
        <td><abbr title="<%= initiative.state.name %>"><%= initiative.state.abbrev %></abbr></td>
        <td><%= initiative.start_year %></td>
        <td><%= initiative.end_year %></td>
        <td><%= initiative.topics.collect(&:name).join(", ") %></td>
        <td><%= initiative.populations.collect(&:target).join(", ") %></td>
        <td><%= initiative.professionaldevelopments.collect(&:name).join(", ") %></td>
        <td><% initiative.implementations.each do |implementation| %>
  				<%= implementation.stages.collect(&:name).join(", ") %>
  			<%end%>
  		</td>
  		<td>
  			<%= initiative.description %>
  		</td>
  		<td>
  			<%= initiative.resources %>
  		</td>
      </tr>
    <% end %>
  </tbody>
</table>